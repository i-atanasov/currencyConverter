<!DOCTYPE html>
<html lang="en" >

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Currency Converter</title>
</head>

<style>
body {
    background-color: rgba(126, 201, 176, 0.397);
    font-family: Arial, Helvetica, sans-serif;
}

h1 {
    padding: 50px 50px 0px;
    font-family:'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
    font-size: 25px;
    text-transform: uppercase;
}

.output {
    max-width: 600px;
    display: grid;
    grid-template-columns: auto auto;
    background-color: #b4caba;
    padding: 50px;
    border-radius: 10px;
}

.currencies {
    padding: 50px;
}

#base_currency, #to_currency, #switchBase {
    border-radius: 10px;
    width: 150px;
    height: 40px;
    color: #b4caba;
    font-size: larger;
    background-color: rgba(73, 61, 61, 1);
}

#baseAmount {
    border-radius: 10px;
    width: 50px;
    height: 35px;
    color: #b4caba;
    font-size: larger;
    background-color: rgba(73, 61, 61, 1);
    margin-right: 20px;
    text-align: right;
}

#calculatedResult {
    font-size: larger;
    font-style: oblique;
    margin: auto;
   
}

</style>

<body>
    <h1>Currency converter</h1>
    <div class = "currencies"><em>Choose amount and currencies:</em><br><br>
       
        <input id = "baseAmount" type = "number" value = 1 min = 0.01>
        from&nbsp;&nbsp;&nbsp;&nbsp;
        <select id = "base_currency">
            <option value = "aud">AUD</option>
            <option value = "bgn">BGN</option>
            <option value = "cad">CAD</option>
            <option value = "chf">CHF</option>
            <option value = "eur">EUR</option>
            <option value = "nzd">NZD</option>
            <option value = "usd" selected>USD</option>
        </select>&nbsp;&nbsp;&nbsp;&nbsp;to&nbsp;&nbsp;&nbsp;&nbsp;
        <select id = "to_currency">
            <option value = "aud">AUD</option>
            <option value = "bgn" selected>BGN</option>
            <option value = "cad">CAD</option>
            <option value = "chf">CHF</option>
            <option value = "eur">EUR</option>
            <option value = "nzd">NZD</option>
            <option value = "usd">USD</option>
        </select>
    </div>
    <div class="output"><button id = "switchBase" onclick=switchBase()>Switch</button>

    <p id = "calculatedResult">
    </p>
    </div>
    
<script>
    var base = document.getElementById("base_currency");
    var to = document.getElementById("to_currency");
    const amountTo = document.getElementById("baseAmount");

    var resultOutput;
    var l = 0;

    base.addEventListener("change", showRates);
    to.addEventListener("change", showRates);
    amountTo.addEventListener("input", showRates);

    showRates();

    function showRates() {
        const toCurrency = to.value;
        const baseCurrency = base.value;
        const amount = amountTo.value;

        
        let requestUrl = "https://cdn.jsdelivr.net/gh/fawazahmed0/currency-api@1/latest/currencies/" + baseCurrency + ".json"
        const xmlhttp = new XMLHttpRequest();        
        xmlhttp.open("GET", requestUrl);
        xmlhttp.send();
        xmlhttp.onload = function() {
            const myObj = JSON.parse(this.responseText);
            
            var rate = (myObj[baseCurrency][toCurrency].toFixed(3));
            resultOutput = (amount*rate).toFixed(2);

            document.getElementById("calculatedResult").innerHTML = amount + " " + baseCurrency.toUpperCase() + "</strong>" + " is " + resultOutput + " " + toCurrency.toUpperCase() + "<br> up to " + myObj.date;    
    }

    }

    function switchBase() {
            var switchVar = base;
            base = to;
            to = switchVar;
    
            showRates();
        }

</script>
